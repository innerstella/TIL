## 리액트에서 배열을 렌더링할 때 key가 필요한 이유

- DOM 노드의 자식들을 재귀적으로 처리할 때, 리액트는 기본적으로 동시에 두 리스트를 순회하고 차이점이 있으면 변경을 생성함
- 하지만, 리스트의 맨 앞에 엘리먼트를 추가하는 경우 큰 비효율이 발생함
  - 모든 리스트에 차이점이 있다고 판단하고 변경됨
  → 이러한 비효율의 문제를 해결하기 위해 리액트는 `key` 속성을 지원함

### `key`

- 자식들이 `key`를 가지고 있다면, 리액트는 `key`를 통해 기존 트리와 자식들이 일치하는지 확인함
- `key`는 리액트가 어떤 항목을 변경, 추가 또는 삭제할 지 식별하는 것을 도움
- `key`는 엘리먼트에 안정적인 고유성을 부여하기 위해 배열 내부의 엘리먼트에 지정해야 함
- `key`는 리스트의 다른 항목들 사이에서 해당 항목을 고유하게 식별할 수 있는 문자열을 사용하는 것이 가장 좋음
  - 대부분 데이터의 id
  - 배열의 항목들 사이에서 고유하면 되고, 전역에서 고유할 필요는 없음

## map의 인덱스를 `key`로 사용할 때 발생하는 문제점

- 배열이 재배열되면, 배열 내부의 엘리먼트에 해당하는 key 값 또한 바뀜
- 컴포넌트는 key를 기반으로 갱신되고 재사용되기 때문에, 컴포넌트의 key 값이 바뀌면서 컴포넌트의 state가 꼬이거나 의도하지 않은 방식으로 바뀌는 문제가 발생할 수 있음

## 인덱스를 `key` 로 설정해도 괜찮은 경우

1. 배열의 항목들이 계산을 거쳐 만들어지지 않아 **정적이고, 변경되지 않을 것**
2. 렌더링할 항목에 안정적인 id가 없을 것
3. 배열을 재배열하거나 필터하지 않을 것

이 3가지 조건을 모두 만족할 때, 최후의 수단으로 인덱스를 key로 사용할 수 있음

(uuid, nanoid 등 사용 가능)

---

### 참고 자료

1. https://ko.legacy.reactjs.org/docs/lists-and-keys.html#keys
